

-- T·∫£i Fluent UI Library
local Library = loadstring(game:HttpGetAsync("https://github.com/ActualMasterOogway/Fluent-Renewed/releases/latest/download/Fluent.luau"))()
-- √Çm thanh kh·ªüi ƒë·ªông
local startupSound = Instance.new("Sound")
startupSound.SoundId = "rbxassetid://8594342648"
startupSound.Volume = 5 -- ƒêi·ªÅu ch·ªânh √¢m l∆∞·ª£ng n·∫øu c·∫ßn
startupSound.Looped = false -- Kh√¥ng l·∫∑p l·∫°i √¢m thanh
startupSound.Parent = game.CoreGui-- ƒê·∫∑t parent v√†o CoreGui ƒë·ªÉ ƒë·∫£m b·∫£o √¢m thanh ph√°t
startupSound:Play() -- Ph√°t √¢m thanh khi script ch·∫°y
-- T·∫°o c·ª≠a s·ªï ch√≠nh
local Window = Library:CreateWindow{
    Title = "#OlwenTh",
    SubTitle = "@kevinproxlucky",
    TabWidth = 160,
    Size = UDim2.fromOffset(1280, 860),
    Resize = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.RightControl -- Ph√≠m thu nh·ªè
}

-- T·∫°o ScreenGui ch·ª©a n√∫t ƒëi·ªÅu khi·ªÉn
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ControlGUI"
screenGui.Parent = game.CoreGui

-- T·∫°o n√∫t (ImageButton)
local toggleButton = Instance.new("ImageButton")
toggleButton.Size = UDim2.new(0, 50, 0, 50) -- K√≠ch th∆∞·ªõc nh·ªè, h√¨nh vu√¥ng
toggleButton.Position = UDim2.new(1, -60, 0, 10) -- V·ªã tr√≠ g·∫ßn g√≥c ph·∫£i tr√™n
toggleButton.Image = "rbxassetid://7229442422" -- H√¨nh ·∫£nh c·ªßa n√∫t
toggleButton.BackgroundTransparency = 1 -- Kh√¥ng c√≥ n·ªÅn
toggleButton.Parent = screenGui

-- Bi·∫øn l∆∞u tr·∫°ng th√°i hi·ªÉn th·ªã Fluent UI
local isFluentVisible = true

-- Di chuy·ªÉn n√∫t
local dragging, dragInput, dragStart, startPos

local function update(input)
    local delta = input.Position - dragStart
    toggleButton.Position = UDim2.new(
        startPos.X.Scale,
        startPos.X.Offset + delta.X,
        startPos.Y.Scale,
        startPos.Y.Offset + delta.Y
    )
end

toggleButton.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = toggleButton.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

toggleButton.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        update(input)
    end
end)

-- ·∫®n/Hi·ªán Fluent UI khi nh·∫•n n√∫t
toggleButton.MouseButton1Click:Connect(function()
    isFluentVisible = not isFluentVisible

    if isFluentVisible then
        -- Hi·ªán Fluent UI
        Window:Minimize(false) -- M·ªü l·∫°i c·ª≠a s·ªï
    else
        -- ·∫®n Fluent UI
        Window:Minimize(true) -- Thu nh·ªè c·ª≠a s·ªï
    end
end)

-- T·∫°o c√°c tab
local MainTab = Window:AddTab({ Title = "Main", Icon = "" })
local PlayerTab = Window:AddTab({ Title = "Player", Icon = "" })
local IslandTab = Window:AddTab({ Title = "ƒê·∫£o üèùÔ∏è", Icon = "" })
local OtherTab = Window:AddTab({ Title = "Kh√°c", Icon = "" })
local FruitTab = Window:AddTab({ Title = "Fruit", Icon = "" }) -- Tab Fruit m·ªõi

-- Bi·∫øn to√†n c·ª•c
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer
local Fluent = Library -- G√°n bi·∫øn Fluent

local currentTween = nil
local leviathanGateConnection = nil
local rockConnection = nil -- No longer used for DescendantAdded
local scriptEnabled = false
local lockHeightMode = true
local destroyRockMode = false
local customY = 100
local tweenSpeed = 350
local minimized = false
local lastBoat, lastSeat = nil, nil
local playerTweening = false -- Kh√¥i ph·ª•c bi·∫øn playerTweening
local autoReturnEnabled = false
local killAuraEnabled = false
local killAuraRange = 100
local selectedIslandCoord = nil
local islandTweening = false
local boatProtectEnabled = false -- B·∫£o v·ªá thuy·ªÅn
local boatProtectImmediateEnabled = false -- B·∫£o v·ªá thuy·ªÅn ngay l·∫≠p t·ª©c
local boatProtectTween = nil
local boatProtectConnection = nil
local originalBoatProtectY = nil
local currentBoat = nil
_G.Random_Auto = false -- Auto Random Fruit
local selectedPlayer = nil -- Bi·∫øn l∆∞u player ƒë∆∞·ª£c ch·ªçn cho Spectate v√† Tween Player
local playerTweenInfo = nil
local rockTouchConnection = nil -- Bi·∫øn connection cho s·ª± ki·ªán ch·∫°m ƒë√°

-- Danh s√°ch ƒë·∫£o
local islands = {
    Tiki = Vector3.new(-16208.6, 10.4, 500.9),
    Hydra = Vector3.new(5164.5, 48.1, 2094.1),
    ["Ph√°o ƒë√†i"] = Vector3.new(-5122.9, 315.7, -2961.9),
    ["Dinh Th·ª±"] = Vector3.new(-12551.5, 338.5, -7552.3),
    ["L√¢u ƒê√†i B√≥ng T·ªëi"] = Vector3.new(-9508.9, 158.4, 4894.1),
    ["C·∫£ng"] = Vector3.new(-221.3, 22.3, 5517.8),
    ["C√¢y ƒê·∫°i Th·ª•"] = Vector3.new(2130.8, 23.1, -6635.9),
    ["ƒê·∫£o B√°nh"] = Vector3.new(-1928.6, 15.1, -11582.4)
}

-- H√†m h·ªó tr·ª£
local function setBoatNoClip(boat, enable)
    for _, desc in ipairs(boat:GetDescendants()) do
        if desc:IsA("BasePart") then
            desc.CanCollide = not enable
        end
    end
end

local function setPlayerNoClip(char, enable)
    for _, desc in ipairs(char:GetDescendants()) do
        if desc:IsA("BasePart") then
            desc.CanCollide = not enable
        end
    end
end

local function getBoatVehicleSeat()
    local boatsFolder = Workspace:FindFirstChild("Boats")
    if not boatsFolder then return nil, nil end

    for _, boat in ipairs(boatsFolder:GetChildren()) do
        local seat = boat:FindFirstChild("VehicleSeat")
        if seat and seat.Occupant and seat.Occupant.Parent == LocalPlayer.Character then
            return boat, seat
        end
    end
    return nil, nil
end

local function stopTween(reason)
    if currentTween then
        currentTween:Cancel()
        currentTween = nil
        print(reason or "Tween d·ª´ng.")
    end
    if leviathanGateConnection then
        leviathanGateConnection:Disconnect()
        leviathanGateConnection = nil
    end
    if playerTweenInfo then
        playerTweenInfo:Cancel()
        playerTweenInfo = nil
    end
    scriptEnabled = false
    playerTweening = false
    islandTweening = false
    local boat, _ = getBoatVehicleSeat()
    if boat then
        setBoatNoClip(boat, false)
    end
    if LocalPlayer.Character then
        setPlayerNoClip(LocalPlayer.Character, false)
    end
    stopBoatProtect() -- D·ª´ng b·∫£o v·ªá thuy·ªÅn khi tween d·ª´ng
    setRockDestruction(false) -- Ensure rock destruction is off when tween is stopped
end

local function stopIfMapObjectAppears(child)
    if child.Name == "LeviathanGate" then
        stopTween("LeviathanGate xu·∫•t hi·ªán.")
    elseif child.Name == "PrehistoricIsland" then
        stopTween("PrehistoricIsland xu·∫•t hi·ªán.")
    end
end

local function checkLeaveBoat()
    local _, seat = getBoatVehicleSeat()
    if not seat then
        stopTween("B·∫°n ƒë√£ r·ªùi thuy·ªÅn.")
    end
end

local function tweenBoatToVector3(targetPos)
    -- N·∫øu ƒëang tween => d·ª´ng c≈©
    if currentTween then
        stopTween("D·ª´ng tween c≈©.")
    end
    local boat, seat = getBoatVehicleSeat()
    if not boat then
        warn("Kh√¥ng t√¨m th·∫•y thuy·ªÅn b·∫°n ƒëang ng·ªìi!")
        return
    end
    lastBoat, lastSeat = boat, seat
    currentBoat = boat -- C·∫≠p nh·∫≠t thuy·ªÅn hi·ªán t·∫°i cho b·∫£o v·ªá thuy·ªÅn

    local primary = boat.PrimaryPart
    if not primary then
        warn("Thuy·ªÅn kh√¥ng c√≥ PrimaryPart!")
        return
    end

    -- B·∫≠t no clip
    setBoatNoClip(boat, true)
    if LocalPlayer.Character then
        setPlayerNoClip(LocalPlayer.Character, true)
    end

    local currentPos = primary.Position
    local finalY = lockHeightMode and customY or currentPos.Y
    if lockHeightMode then
        primary.CFrame = CFrame.new(currentPos.X, finalY, currentPos.Z)
    end

    local distance = (Vector3.new(targetPos.X, finalY, targetPos.Z) - primary.Position).Magnitude
    local tweenTime = distance / tweenSpeed

    local tweenInfo = TweenInfo.new(tweenTime, Enum.EasingStyle.Linear, Enum.EasingDirection.Out)
    local goal = { CFrame = CFrame.new(targetPos.X, finalY, targetPos.Z) }

    currentTween = TweenService:Create(primary, tweenInfo, goal)
    currentTween:Play()

    task.spawn(function()
        while currentTween and currentTween.PlaybackState == Enum.PlaybackState.Playing do
            checkLeaveBoat()
            task.wait(0.1)
        end
        -- Khi tween xong => t·∫Øt no clip
        setBoatNoClip(boat, false)
        if LocalPlayer.Character then
            setPlayerNoClip(LocalPlayer.Character, false)
        end
        islandTweening = false
        currentBoat = nil -- Reset thuy·ªÅn hi·ªán t·∫°i khi tween xong
    end)

    -- Theo d√µi LeviathanGate/PrehistoricIsland
    if leviathanGateConnection then
        leviathanGateConnection:Disconnect()
    end
    leviathanGateConnection = Workspace:WaitForChild("Map").ChildAdded:Connect(stopIfMapObjectAppears)
end

-- H√†m Tween thuy·ªÅn ƒë·∫øn player
local function tweenBoatToPlayer(targetPlayer)
    if playerTweening then
        warn("ƒêang Tween ƒë·∫øn player kh√°c, h√£y STOP tr∆∞·ªõc.")
        return
    end
    playerTweening = true

    -- N·∫øu ƒëang tween => d·ª´ng c≈©
    if currentTween then
        stopTween("D·ª´ng tween c≈©.")
    end

    local boat, seat = getBoatVehicleSeat()
    if not boat then
        warn("Kh√¥ng t√¨m th·∫•y thuy·ªÅn ƒëang ng·ªìi!")
        playerTweening = false
        return
    end
    lastBoat, lastSeat = boat, seat

    local primary = boat.PrimaryPart
    if not primary then
        warn("Thuy·ªÅn kh√¥ng c√≥ PrimaryPart!")
        playerTweening = false
        return
    end

    -- B·∫≠t no clip
    setBoatNoClip(boat, true)
    if LocalPlayer.Character then
        setPlayerNoClip(LocalPlayer.Character, true)
    end

    local char = targetPlayer.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then
        warn("Player ch∆∞a load xong ho·∫∑c kh√¥ng c√≥ HRP!")
        playerTweening = false
        -- T·∫Øt no clip
        setBoatNoClip(boat, false)
        if LocalPlayer.Character then
            setPlayerNoClip(LocalPlayer.Character, false)
        end
        return
    end

    local playerPos = char.HumanoidRootPart.Position
    local currentPos = primary.Position
    local finalY = lockHeightMode and customY or currentPos.Y
    if lockHeightMode then
        primary.CFrame = CFrame.new(currentPos.X, finalY, currentPos.Z)
    end

    local distance = (Vector3.new(playerPos.X, finalY, playerPos.Z) - primary.Position).Magnitude
    local tweenTime = distance / tweenSpeed

    local tweenInfo = TweenInfo.new(tweenTime, Enum.EasingStyle.Linear, Enum.EasingDirection.Out)
    local goal = { CFrame = CFrame.new(playerPos.X, finalY, playerPos.Z) }

    playerTweenInfo = TweenService:Create(primary, tweenInfo, goal)
    playerTweenInfo:Play()

    task.spawn(function()
        while playerTweenInfo and playerTweenInfo.PlaybackState == Enum.PlaybackState.Playing do
            checkLeaveBoat()
            task.wait(0.1)
        end
        -- T·∫Øt no clip
        setBoatNoClip(boat, false)
        if LocalPlayer.Character then
            setPlayerNoClip(LocalPlayer.Character, false)
        end
        playerTweening = false
    end)

    if leviathanGateConnection then
        leviathanGateConnection:Disconnect()
    end
    leviathanGateConnection = Workspace:WaitForChild("Map").ChildAdded:Connect(stopIfMapObjectAppears)
end

-- H√†m Auto Return
local function autoReturnCheck()
    while autoReturnEnabled do
        if lastBoat and lastSeat and lastBoat.Parent then
            local char = LocalPlayer.Character
            local hrp = char and char:FindFirstChild("HumanoidRootPart")
            if hrp then
                local seatPos = lastSeat.Position
                local distance = (hrp.Position - seatPos).Magnitude
                if distance > 10 then
                    local speed = 300
                    local time = distance / speed

                    local info = TweenInfo.new(time, Enum.EasingStyle.Linear, Enum.EasingDirection.Out)
                    local goal = { CFrame = CFrame.new(seatPos + Vector3.new(0,3,0)) }
                    local tween = TweenService:Create(hrp, info, goal)
                    tween:Play()
                end
            end
        end
        task.wait(1)
    end
end

-- H√†m Kill Aura
local function killAuraLoop()
    local monstersFolder = Workspace:FindFirstChild("Enemies")
    while killAuraEnabled do
        task.wait(1)
        local char = LocalPlayer.Character
        if not char then continue end
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hrp or not monstersFolder then continue end

        for _, monster in pairs(monstersFolder:GetChildren()) do
            local hum = monster:FindFirstChild("Humanoid")
            local mrp = monster:FindFirstChild("HumanoidRootPart")
            if hum and mrp and hum.Health > 0 then
                local distance = (mrp.Position - hrp.Position).Magnitude
                if distance <= killAuraRange then
                    hum.Health = 0
                end
            end
        end
    end
end

-- H√†m Anti Die
local antiDieEnabled = false
local originalPosition = nil
local teleporting = false
local function teleportPlayerUp()
    while antiDieEnabled and teleporting do
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            local hrp = character.HumanoidRootPart
            hrp.CFrame = hrp.CFrame + Vector3.new(0, 200, 0) -- Teleport l√™n 200 studs
        end
        task.wait(0.1) -- L·∫∑p l·∫°i sau m·ªói 0.1 gi√¢y
    end
end

local function checkHealth()
    while antiDieEnabled do
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("Humanoid") then
            local humanoid = character.Humanoid
            if humanoid.Health == 0 then
                teleporting = false
            elseif humanoid.Health <= (humanoid.MaxHealth * 0.3) then
                if not teleporting then
                    teleporting = true
                    originalPosition = character.HumanoidRootPart.Position -- L∆∞u v·ªã tr√≠ c≈©
                    teleportPlayerUp() -- B·∫Øt ƒë·∫ßu teleport l√™n tr·ªùi
                end
            else
                if teleporting then
                    if originalPosition then
                        local hrp = character:FindFirstChild("HumanoidRootPart")
                        if hrp then
                            hrp.CFrame = CFrame.new(originalPosition)
                        end
                        originalPosition = nil
                    end
                    teleporting = false -- D·ª´ng teleport n·∫øu HP > 30%
                end
            end
        end
        task.wait(0.1) -- Ki·ªÉm tra HP m·ªói 0.1 gi√¢y
    end
end

-- H√†m DashNoCD
_G.DodgewithoutCool = false
local dashNoCDEnabled = false
local function NoCooldown()
    if _G.DodgewithoutCool then
        local player = game.Players.LocalPlayer
        local character = player.Character or player.CharacterAdded:Wait() -- Ch·ªù nh√¢n v·∫≠t ƒë∆∞·ª£c load.

        -- ƒê·∫£m b·∫£o ch·ªù 1 gi√¢y sau khi respawn
        wait(3)

        for i, v in next, getgc() do
            if typeof(v) == "function" then
                if getfenv(v).script == character:WaitForChild("Dodge") then
                    for i2, v2 in next, getupvalues(v) do
                        if tostring(v2) == "0.4" then -- Gi√° tr·ªã cooldown g·ªëc.
                            repeat
                                wait(0.1) -- Ki·ªÉm tra cooldown li√™n t·ª•c.
                                setupvalue(v, i2, 0) -- ƒê·∫∑t cooldown th√†nh 0.
                            until not _G.DodgewithoutCool
                        end
                    end
                end
            end
        end
    end
end

-- H√†m WalkSpeed
local hb = game:GetService("RunService").Heartbeat
local speaker = game:GetService("Players").LocalPlayer
local tpwalking = false
local currentSpeed = 90  -- M·∫∑c ƒë·ªãnh ban ƒë·∫ßu l√† 90
local walkSpeedEnabled = false
local function startTeleportWalk(character)
    local hum = character:WaitForChild("Humanoid")

    -- L·∫Øng nghe s·ª± ki·ªán thay ƒë·ªïi m√°u
    hum.HealthChanged:Connect(function(health)
        local maxHealth = hum.MaxHealth
        local hpPercent = (health / maxHealth) * 100
        if hpPercent <= 30 then
            currentSpeed = 190
        elseif hpPercent >= 50 then
            currentSpeed = 90
        end
        -- N·∫øu mu·ªën c√≥ th√™m logic cho m·ª©c 30%-50% th√¨ th√™m v√†o ƒë√¢y
    end)

    while tpwalking and hum and hum.Parent do
        local delta = hb:Wait()
        if hum.MoveDirection.Magnitude > 0 then
            character:TranslateBy(hum.MoveDirection * currentSpeed * delta)
        end
    end
end

-- L·∫Øng nghe s·ª± ki·ªán nh√¢n v·∫≠t t√°i sinh
speaker.CharacterAdded:Connect(function(character)
    if tpwalking then
        startTeleportWalk(character)
    end
end)

-- N·∫øu nh√¢n v·∫≠t ƒë√£ t·ªìn t·∫°i, ch·∫°y ngay l·∫≠p t·ª©c
if speaker.Character and tpwalking then
    startTeleportWalk(speaker.Character)
end

-- H√†m Gas
local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local toggleNoCooldown = false
local gasEnabled = false

-- H√†m hi·ªÉn th·ªã th√¥ng b√°o
local function notify(title, text)
    StarterGui:SetCore("SendNotification", {
        Title = title;
        Text = text;
        Duration = 3; -- Th·ªùi gian hi·ªÉn th·ªã th√¥ng b√°o
    })
end

-- H√†m t·∫°o Tool v√† c√†i ƒë·∫∑t toggle
local function createNoCooldownTool()
    local backpack = player:FindFirstChild("Backpack")
    if not backpack then
        return
    end

    -- Ki·ªÉm tra n·∫øu Tool ƒë√£ t·ªìn t·∫°i, n·∫øu c√≥ th√¨ x√≥a tr∆∞·ªõc
    local oldTool = backpack:FindFirstChild("NoCooldownToggle")
    if oldTool then
        oldTool:Destroy()
    end

    -- T·∫°o Tool
    local tool = Instance.new("Tool")
    tool.Name = "NoCooldownToggle"
    tool.RequiresHandle = false
    tool.CanBeDropped = false
    tool.Parent = backpack

    -- Khi Tool ƒë∆∞·ª£c nh·∫•n (Activated), b·∫≠t/t·∫Øt t√≠nh nƒÉng NoCooldown
    tool.Activated:Connect(function()
        toggleNoCooldown = not toggleNoCooldown
        if toggleNoCooldown then
            notify("No Cooldown M1", "Enabled")
        else
            notify("No Cooldown M1", "Disabled")
        end
    end)
end

-- G·ªçi h√†m spawn ƒë·ªÉ th·ª±c thi li√™n t·ª•c ki·ªÉm tra NoCooldown
task.spawn(function()
    while task.wait(0.1) do
        if toggleNoCooldown then
            local backpack = player:FindFirstChild("Backpack")
            local character = player.Character
            if not backpack or not character then
                continue
            end

            local tool = backpack:FindFirstChild("Gas-Gas") or character:FindFirstChild("Gas-Gas")
            if tool then
                -- Nh·∫•n chu·ªôt tr√°i t·∫•n c√¥ng
                local leftClickRemote = tool:FindFirstChild("LeftClickRemote")
                if leftClickRemote then
                    local hrp = character:FindFirstChild("HumanoidRootPart")
                    local direction = hrp and hrp.CFrame.LookVector or Vector3.new(0, 0, -1)
                    local args = {
                        [1] = direction, -- H∆∞·ªõng ph√≠a tr∆∞·ªõc
                        [2] = 4         -- S·ª©c m·∫°nh ho·∫∑c t·∫ßm ƒë√°nh
                    }
                    leftClickRemote:FireServer(unpack(args))
                end

                -- G·ª≠i s·ª± ki·ªán t·∫Øt cooldown
                local remoteEvent = tool:FindFirstChild("RemoteEvent")
                if remoteEvent then
                    local args = {
                        [1] = false -- V√¥ hi·ªáu h√≥a cooldown
                    }
                    remoteEvent:FireServer(unpack(args))
                end
            end
        end
    end
end)

-- Find Fruit
local fruitsESP = {}
local findFruitEnabled = false
local function createESP(fruit)
    if not fruit:FindFirstChild("Handle") then return end

    if fruitsESP[fruit] then
        fruitsESP[fruit]:Destroy()
        fruitsESP[fruit] = nil
    end

    local billboard = Instance.new("BillboardGui")
    billboard.Adornee = fruit.Handle
    billboard.Size = UDim2.new(0, 200, 0, 50)
    billboard.StudsOffset = Vector3.new(0, 2, 0)
    billboard.AlwaysOnTop = true

    local label = Instance.new("TextLabel", billboard)
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = fruit.Name
    label.TextColor3 = Color3.fromRGB(255, 255, 0)
    label.TextScaled = true

    billboard.Parent = fruit
    fruitsESP[fruit] = billboard
end

local function findFruits()
    local fruits = {}
    for _, object in pairs(workspace:GetChildren()) do
        if object:IsA("Tool") and object.Name:lower():find("fruit") then
            table.insert(fruits, object)
            if findFruitEnabled then
                createESP(object)
            end
        end
    end
    return fruits
end

local function teleportToFruit(fruit)
    if fruit and fruit:FindFirstChild("Handle") then
        if findFruitEnabled then
            LocalPlayer.Character.HumanoidRootPart.CFrame = fruit.Handle.CFrame
        end
    end
end

local runService = game:GetService("RunService")
runService.Heartbeat:Connect(function()
    local fruits = findFruits()
    if #fruits > 0 then
        for _, fruit in pairs(fruits) do
            if fruit.Parent == workspace then
                teleportToFruit(fruit)
                wait(1)
            end
        end
    end
end)

workspace.ChildAdded:Connect(function(child)
    if child:IsA("Tool") and child.Name:lower():find("fruit") then
        wait(0.5)
        if findFruitEnabled then
            createESP(child)
        end
        teleportToFruit(child)
    end
end)

workspace.ChildRemoved:Connect(function(child)
    if fruitsESP[child] then
        fruitsESP[child]:Destroy()
        fruitsESP[child] = nil
    end
end)

-- Boat Protect
local function tweenBoatToProtectHeight(boat)
    local primary = boat.PrimaryPart
    if not primary then
        warn("Thuy·ªÅn kh√¥ng c√≥ PrimaryPart ƒë·ªÉ tween b·∫£o v·ªá!")
        return
    end

    local currentPos = primary.Position
    local targetY = 200 -- M·∫∑c ƒë·ªãnh l√† 200
    if lockHeightMode then -- N·∫øu b·∫≠t kh√≥a ƒë·ªô cao
        local numY = tonumber(customY)
        if numY then
            targetY = numY -- S·ª≠ d·ª•ng gi√° tr·ªã Y ƒë√£ nh·∫≠p n·∫øu h·ª£p l·ªá
        end
    end

    if not originalBoatProtectY then
        originalBoatProtectY = currentPos.Y
    end

    local distance = math.abs(targetY - currentPos.Y)
    local tweenTime = distance / tweenSpeed

    local tweenInfo = TweenInfo.new(tweenTime, Enum.EasingStyle.Linear, Enum.EasingDirection.Out)
    local goal = { CFrame = CFrame.new(currentPos.X, targetY, currentPos.Z) }

    if boatProtectTween then
        boatProtectTween:Cancel()
        boatProtectTween = nil
    end

    setBoatNoClip(boat, true)
    if LocalPlayer.Character then
        setPlayerNoClip(LocalPlayer.Character, true)
    end

    boatProtectTween = TweenService:Create(primary, tweenInfo, goal)
    boatProtectTween:Play()

    local startY = currentPos.Y
    task.spawn(function()
        while boatProtectTween and boatProtectTween.PlaybackState == Enum.PlaybackState.Playing do
            task.wait(0.1)
            if boat and primary then
                local newCurrentPos = primary.Position
                local newTargetY = targetY
                if lockHeightMode then -- Update targetY during tween if lockHeightMode is on
                    local numY = tonumber(customY)
                    if numY then
                        newTargetY = numY
                    end
                end
                primary.CFrame = CFrame.new(newCurrentPos.X, newTargetY, newCurrentPos.Z)
            end
        end
        if not boatProtectImmediateEnabled then
            setBoatNoClip(boat, false)
            if LocalPlayer.Character then
                setPlayerNoClip(LocalPlayer.Character, false)
            end
        end
    end)
end

local function checkBoatHealth()
    while boatProtectEnabled do
        task.wait(1)
        local boat = currentBoat
        if not boat then
            boat, _ = getBoatVehicleSeat()
            currentBoat = boat
        end
        if boat then
            local primary = boat.PrimaryPart
            if primary then
                local currentPos = primary.Position
                local boatHealth = 100 -- M√°u thuy·ªÅn (c√≥ th·ªÉ c·∫ßn ƒëi·ªÅu ch·ªânh logic l·∫•y m√°u thuy·ªÅn n·∫øu c√≥)
                local char = LocalPlayer.Character
                if char then
                    local humanoid = char:FindFirstChild("Humanoid")
                    if humanoid then
                        boatHealth = humanoid.Health -- T·∫°m th·ªùi d√πng m√°u ng∆∞·ªùi ch∆°i l√†m m√°u thuy·ªÅn
                    end
                end

                local currentY = primary.Position.Y
                local targetY = 200
                if lockHeightMode then
                    local numY = tonumber(customY)
                    if numY then
                        targetY = numY
                    else
                        targetY = 200 -- Default to 200 if customY is not valid and lockHeightMode is on
                    end
                end

                if boatHealth <= 50 or (originalBoatProtectY and math.abs(currentY - originalBoatProtectY) > 10 ) then
                    if not boatProtectImmediateEnabled then
                        tweenBoatToProtectHeight(boat)
                    end
                end
            end
        else
            currentBoat = nil
        end
    end
end

local function boatProtectImmediateLoop()
    while boatProtectImmediateEnabled do
        task.wait(1)
        local boat = currentBoat
        if not boat then
            boat, _ = getBoatVehicleSeat()
            currentBoat = boat
        end
        if boat then
            tweenBoatToProtectHeight(boat)
        else
            currentBoat = nil
        end
    end
end

-- Function to stop boat protect
local function stopBoatProtect()
    if boatProtectTween then
        boatProtectTween:Cancel()
        boatProtectTween = nil
    end
    local boat = currentBoat
    if boat then
        setBoatNoClip(boat, false)
        if LocalPlayer.Character then
            setPlayerNoClip(LocalPlayer.Character, false)
        end
    end

    if boatProtectConnection then
        boatProtectConnection:Disconnect()
        boatProtectConnection = nil
    end

    currentBoat = nil
    originalBoatProtectY = nil
end

-- Rock Destruction Logic
local rockDestructionLoop = nil -- Bi·∫øn ƒë·ªÉ l∆∞u task loop ph√° ƒë√°

local function setRockDestruction(enabled)
    destroyRockMode = enabled -- C·∫≠p nh·∫≠t tr·∫°ng th√°i destroyRockMode

    if rockDestructionLoop then -- N·∫øu loop ƒëang ch·∫°y, d·ª´ng n√≥
        task.cancel(rockDestructionLoop)
        rockDestructionLoop = nil
    end

    if enabled then
        rockDestructionLoop = task.spawn(function() -- B·∫Øt ƒë·∫ßu loop m·ªõi
            while destroyRockMode do -- Loop ch·ªâ ch·∫°y khi destroyRockMode l√† true
                local rocksFolder = Workspace:FindFirstChild("Rocks")
                if rocksFolder then
                    for _, rock in ipairs(rocksFolder:GetChildren()) do
                        if rock:IsA("BasePart") then
                            pcall(function() -- S·ª≠ d·ª•ng pcall ƒë·ªÉ tr√°nh l·ªói script khi destroy object
                                rock:Destroy()
                            end)
                        end
                    end
                end
                task.wait(0.1) -- Ch·ªù m·ªôt ch√∫t tr∆∞·ªõc khi ki·ªÉm tra l·∫°i, gi·∫£m t·∫£i cho game
            end
            print("Rock Destruction Loop Stopped") -- Feedback when loop stops
        end)
        print("Rock Destruction Enabled - Continuous") -- Feedback when enabled
    else
        print("Rock Destruction Disabled") -- Feedback when disabled
    end
end


-- Tab Main
MainTab:AddToggle("LevithanToggle", {
    Title = "T√¨m Levithan v√† üåã",
    Description = "B·∫≠t/T·∫Øt t√¨m Levithan v√† üåã",
    Callback = function(Value)
        if Value then -- Toggle is ON
            if not scriptEnabled then -- Only start if not already enabled
                scriptEnabled = true
                tweenBoatToVector3(Vector3.new(-99999999, 0, 0))
            end
        else -- Toggle is OFF
            if scriptEnabled then -- Only stop if currently enabled
                stopTween("Ng∆∞·ªùi d√πng t·∫Øt T√¨m Levithan.")
            end
        end
    end
})

MainTab:AddToggle("Kh√≥a", {
    Title = "Bay Thuy·ªÅn ‚õµ",
    Description = "B·∫≠t/T·∫Øt kh√≥a Bay ‚õµ",
    Callback = function(Value)
        lockHeightMode = Value
    end
})

MainTab:AddToggle("Rock", {
    Title = "Ph√° ƒë√°",
    Description = "B·∫≠t/T·∫Øt ph√° ƒë√° li√™n t·ª•c",
    Callback = function(Value)
        setRockDestruction(Value) --  <- This line calls the setRockDestruction function NOW.
    end
})

MainTab:AddInput("Y", {
    Title = "ƒê·ªô cao Bay",
    Description = "Nh·∫≠p ƒë·ªô cao ",
    Callback = function(Value)
        local val = tonumber(Value)
        if val then
            customY = val
        else
            customY = 100
        end
    end
})

MainTab:AddInput("Speed", {
    Title = "T·ªëc ƒë·ªô",
    Description = "Nh·∫≠p t·ªëc ƒë·ªô tween",
    Callback = function(Value)
        local val = tonumber(Value)
        if val and val > 0 then
            tweenSpeed = val
        else
            tweenSpeed = 350
        end
    end
})

MainTab:AddToggle("Auto Return", {
    Title = "T·ª± ƒë·ªông tr·ªü v·ªÅ ‚õµ",
    Description = "B·∫≠t/T·∫Øt t·ª± ƒë·ªông tr·ªü v·ªÅ ‚õµ",
    Callback = function(Value)
        autoReturnEnabled = Value
        if autoReturnEnabled then
            task.spawn(autoReturnCheck)
        end
    end
})

MainTab:AddToggle("Kill Aura", {
    Title = "Golem v√† Qu√°i t·ª± ch·∫øt",
    Description = "B·∫≠t/T·∫Øt Kill Aura",
    Callback = function(Value)
        killAuraEnabled = Value
        if killAuraEnabled then
            task.spawn(killAuraLoop)
        end
    end
})

-- Tab Player
local playerDropdown = PlayerTab:AddDropdown("Ch·ªçn ng∆∞·ªùi ch∆°i", {
    Title = "Ch·ªçn ng∆∞·ªùi ch∆°i",
    Description = "Danh s√°ch ng∆∞·ªùi ch∆°i",
    Values = {}, -- Danh s√°ch ng∆∞·ªùi ch∆°i s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t sau
    Callback = function(Value)
        local selected = Players:FindFirstChild(Value)
        if selected then
            selectedPlayer = selected
            print("ƒê√£ ch·ªçn ng∆∞·ªùi ch∆°i:", Value)
        else
            selectedPlayer = nil
            print("Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi ch∆°i: ", Value)
        end
    end
})

-- H√†m l√†m m·ªõi danh s√°ch ng∆∞·ªùi ch∆°i
local function refreshPlayerList()
    local playerNames = {}
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            table.insert(playerNames, player.Name)
        end
    end
    playerDropdown:SetValues(playerNames) -- C·∫≠p nh·∫≠t danh s√°ch ng∆∞·ªùi ch∆°i
end

-- Th√™m TextBox ƒë·ªÉ t√¨m t√™n ng∆∞·ªùi ch∆°i
local playerSearchBox = PlayerTab:AddInput("T√¨m ng∆∞·ªùi ch∆°i", {
    Title = "T√¨m ng∆∞·ªùi ch∆°i",
    Description = "Nh·∫≠p t√™n ng∆∞·ªùi ch∆°i ƒë·ªÉ t√¨m ki·∫øm",
    Callback = function(Value)
        -- L·ªçc danh s√°ch ng∆∞·ªùi ch∆°i d·ª±a tr√™n t·ª´ kh√≥a
        local filteredPlayers = {}
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and string.find(string.lower(player.Name), string.lower(Value)) then
                table.insert(filteredPlayers, player.Name)
            end
        end
        playerDropdown:SetValues(filteredPlayers) -- C·∫≠p nh·∫≠t danh s√°ch ng∆∞·ªùi ch∆°i
    end
})

-- N√∫t Refresh
PlayerTab:AddButton({
    Title = "Refresh",
    Description = "L√†m m·ªõi danh s√°ch ng∆∞·ªùi ch∆°i",
    Callback = function()
        refreshPlayerList()
    end
})

-- L√†m m·ªõi danh s√°ch ng∆∞·ªùi ch∆°i khi m·ªü tab
refreshPlayerList()

-- Tab ƒê·∫£o
local islandDropdown = IslandTab:AddDropdown("Ch·ªçn ƒë·∫£o", {
    Title = "Ch·ªçn ƒë·∫£o",
    Description = "Danh s√°ch ƒë·∫£o",
    Values = {"Tiki", "Hydra", "Ph√°o ƒë√†i", "Dinh Th·ª±", "L√¢u ƒê√†i B√≥ng T·ªëi", "C·∫£ng", "C√¢y ƒê·∫°i Th·ª•", "ƒê·∫£o B√°nh"},
    Callback = function(Value)
        selectedIslandCoord = islands[Value] -- L∆∞u t·ªça ƒë·ªô ƒë·∫£o ƒë∆∞·ª£c ch·ªçn
        print("ƒê√£ ch·ªçn ƒë·∫£o:", Value)
    end
})

-- Th√™m TextBox ƒë·ªÉ t√¨m t√™n ƒë·∫£o
local islandSearchBox = IslandTab:AddInput("T√¨m ƒë·∫£o", {
    Title = "T√¨m ƒë·∫£o",
    Description = "Nh·∫≠p t√™n ƒë·∫£o ƒë·ªÉ t√¨m ki·∫øm",
    Callback = function(Value)
        -- L·ªçc danh s√°ch ƒë·∫£o d·ª±a tr√™n t·ª´ kh√≥a
        local filteredIslands = {}
        for islandName, _ in pairs(islands) do
            if string.find(string.lower(islandName), string.lower(Value)) then
                table.insert(filteredIslands, islandName)
            end
        end
        islandDropdown:SetValues(filteredIslands) -- C·∫≠p nh·∫≠t danh s√°ch ƒë·∫£o
    end
})

-- N√∫t Tween ƒë·∫øn ƒë·∫£o
IslandTab:AddButton({
    Title = "Tween: OFF",
    Description = "B·∫≠t/T·∫Øt tween ƒë·∫øn ƒë·∫£o",
    Callback = function()
        if islandTweening then
            stopTween("Ng∆∞·ªùi d√πng t·∫Øt Tween ƒê·∫£o.")
            islandTweening = false
            Fluent:Notify({
                Title = "Tween ƒê·∫£o",
                Content = "ƒê√£ t·∫Øt Tween ƒê·∫£o.",
                Duration = 3
            })
        else
            if not selectedIslandCoord then
                Fluent:Notify({
                    Title = "L·ªói",
                    Content = "Ch∆∞a ch·ªçn ƒë·∫£o!",
                    Duration = 3
                })
                return
            end
            islandTweening = true
            Fluent:Notify({
                Title = "Tween ƒê·∫£o",
                Content = "ƒêang tween ƒë·∫øn ƒë·∫£o...",
                Duration = 3
            })
            tweenBoatToVector3(selectedIslandCoord)
        end
    end
})

-- N√∫t Tween ƒë·∫øn Hydra
IslandTab:AddToggle("HydraIslandToggle", {
    Title = "K√©o tim ƒë·∫øn Hydra",
    Description = "B·∫≠t/T·∫Øt K√©o Tim ƒë·∫øn Hydra",
    Callback = function(Value)
        if Value then -- B·∫≠t
            islandTweening = true
            Fluent:Notify({
                Title = "Tween ƒë·∫øn Hydra",
                Content = "ƒêang tween ƒë·∫øn Hydra...",
                Duration = 3
            })
            tweenBoatToVector3(islands["Hydra"])
        else -- T·∫Øt
            stopTween("Ng∆∞·ªùi d√πng t·∫Øt Tween ƒë·∫øn Hydra.")
            islandTweening = false
            Fluent:Notify({
                Title = "Tween ƒë·∫øn Hydra",
                Content = "ƒê√£ t·∫Øt Tween ƒë·∫øn Hydra.",
                Duration = 3
            })
        end
    end
})

-- N√∫t Tween ƒë·∫øn Tiki
IslandTab:AddToggle("TikiIslandToggle", {
    Title = "K√©o tim ƒë·∫øn tiki",
    Description = "B·∫≠t/T·∫Øt K√©o Tim Tiki",
    Callback = function(Value)
        if Value then -- B·∫≠t
            islandTweening = true
            Fluent:Notify({
                Title = "Tween ƒë·∫øn Tiki",
                Content = "ƒêang tween ƒë·∫øn Tiki...",
                Duration = 3
            })
            tweenBoatToVector3(islands["Tiki"])
        else -- T·∫Øt
            stopTween("Ng∆∞·ªùi d√πng t·∫Øt Tween ƒë·∫øn Tiki.")
            islandTweening = false
            Fluent:Notify({
                Title = "Tween ƒë·∫øn Tiki",
                Content = "ƒê√£ t·∫Øt Tween ƒë·∫øn Tiki.",
                Duration = 3
            })
        end
    end
})

-- Tab Kh√°c
OtherTab:AddToggle("Anti Die", {
    Title = "Anti Die",
    Description = "Anti die ch·ªâ c√≥ hi·ªáu l·ª±c khi HP=30%",
    Callback = function(Value)
        antiDieEnabled = Value
        if not antiDieEnabled and originalPosition then
            -- ƒê∆∞a player v·ªÅ v·ªã tr√≠ c≈©
            local character = LocalPlayer.Character
            if character and character:FindFirstChild("HumanoidRootPart") then
                character.HumanoidRootPart.CFrame = CFrame.new(originalPosition)
            end
            originalPosition = nil -- Reset v·ªã tr√≠ c≈©
        end
        if antiDieEnabled then
            task.spawn(checkHealth)
        end
    end
})

OtherTab:AddToggle("DashNoCD", {
    Title = "DashNoCD",
    Description = "B·∫≠t/T·∫Øt DashNoCD",
    Callback = function(Value)
        dashNoCDEnabled = Value
        _G.DodgewithoutCool = dashNoCDEnabled
        if dashNoCDEnabled then
            task.spawn(NoCooldown)
        end
    end
})

OtherTab:AddToggle("WalkSpeed", {
    Title = "WalkSpeed",
    Description = "B·∫≠t/T·∫Øt WalkSpeed",
    Callback = function(Value)
        walkSpeedEnabled = Value
        tpwalking = walkSpeedEnabled
        if walkSpeedEnabled and speaker.Character then
            startTeleportWalk(speaker.Character)
        end
    end
})

OtherTab:AddToggle("Gas", {
    Title = "Gas",
    Description = "D√†nh ri√™ng cho Developer",
    Callback = function(Value)
        local playerName = player.Name
        if playerName == "caubetoi4" then -- Ki·ªÉm tra t√™n ng∆∞·ªùi ch∆°i
            gasEnabled = Value
            if gasEnabled then
                createNoCooldownTool()
            else
                local backpack = LocalPlayer:FindFirstChild("Backpack")
                if backpack then
                    local tool = backpack:FindFirstChild("NoCooldownToggle")
                    if tool then
                        tool:Destroy()
                    end
                end
            end
        else
            gasEnabled = false
            Fluent:Notify({
                Title = "L·ªói",
                Content = "Ch·ªâ Developer m·ªõi d√πng ƒë∆∞·ª£c t√≠nh nƒÉng n√†y",
                Duration = 3
            })
        end
    end
})

-- Boat Protect Toggle
OtherTab:AddToggle("BoatProtect", {
    Title = "B·∫£o V·ªá Thuy·ªÅn üî∞",
    Description = "B·∫≠t/T·∫Øt B·∫£o V·ªá Thuy·ªÅn Khi HP=50%",
    Callback = function(Value)
        boatProtectEnabled = Value
        if boatProtectEnabled then
            task.spawn(checkBoatHealth)
        else
            stopBoatProtect()
        end
    end
})

-- Boat Protect Immediate Toggle
OtherTab:AddToggle("BoatProtectImmediate", {
    Title = "B·∫£o V·ªá Thuy·ªÅn Ngay L·∫≠p T·ª©c",
    Description = "B·∫≠t/T·∫Øt B·∫£o V·ªá Thuy·ªÅn Ngay L·∫≠p T·ª©c",
    Callback = function(Value)
        boatProtectImmediateEnabled = Value
        if boatProtectImmediateEnabled then
            task.spawn(boatProtectImmediateLoop)
            local boat = currentBoat
            if not boat then
                boat, _ = getBoatVehicleSeat()
                currentBoat = boat
            end
            if boat then
                tweenBoatToProtectHeight(boat)
            end
        else
            stopBoatProtect()
        end
    end
})

-- Tab Fruit
FruitTab:AddToggle("Find Fruit", {
    Title = "Find Fruit",
    Description = "T·ª± ƒë·ªông nh·∫∑t Fruit + Esp fruit",
    Callback = function(Value)
        findFruitEnabled = Value
        if not findFruitEnabled then
            local fruits = findFruits()
            for _, fruit in ipairs(fruits) do
                if fruitsESP[fruit] then
                    fruitsESP[fruit]:Destroy()
                    fruitsESP[fruit] = nil
                end
            end
        end
    end
})

-- Auto Random Fruit Toggle
FruitTab:AddToggle("Auto Random Fruit", {
    Title = "Auto Random Fruit",
    Description = "B·∫≠t/T·∫Øt t·ª± ƒë·ªông mua tr√°i √°c qu·ª∑ ng·∫´u nhi√™n",
    Callback = function(state)
        _G.Random_Auto = state
        if state then
            task.spawn(function()
                pcall(function()
                    while _G.Random_Auto do
                        wait(0.1)
                        game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("Cousin", "Buy") -- Mua random fruit
                    end
                end)
            end)
        else
            _G.Random_Auto = false -- Ensure to set _G.Random_Auto to false when disabling
        end
    end
})

-- Tab Player - N√∫t Spectate
PlayerTab:AddToggle("Spectate", {
    Title = "Xem Player",
    Description = "B·∫≠t/T·∫Øt Xem Player",
    Callback = function(Value)
        if Value then
            if selectedPlayer and selectedPlayer.Character then
                localplr = LocalPlayer
                localplr.CameraMaxZoomDistance = 100
                localplr.CameraMinZoomDistance = 0.1
                workspace.CurrentCamera.CameraSubject = selectedPlayer.Character
            end
        else
            workspace.CurrentCamera.CameraSubject = LocalPlayer.Character
        end
    end
})

-- N√∫t Tween Player trong Tab "Player"
PlayerTab:AddButton({
    Title = "Tween Player",
    Description = "Tween boat ƒë·∫øn Player ƒë√£ ch·ªçn",
    Callback = function()
        if playerTweening then
            stopTween("Ng∆∞·ªùi d√πng t·∫Øt Tween Player.")
            playerTweening = false
            Fluent:Notify({
                Title = "Tween Player",
                Content = "ƒê√£ t·∫Øt Tween Player.",
                Duration = 3
            })
            return -- Th√™m return ƒë·ªÉ ngƒÉn g·ªçi tweenBoatToPlayer khi ƒëang tween
        end
        if not selectedPlayer then
            Fluent:Notify({
                Title = "L·ªói",
                Content = "Ch∆∞a ch·ªçn player!",
                Duration = 3
            })
            return
        end
        Fluent:Notify({
            Title = "Tween Player",
            Content = "ƒêang tween ƒë·∫øn player...",
            Duration = 3
        })
        tweenBoatToPlayer(selectedPlayer) -- G·ªçi h√†m tweenBoatToPlayer ƒë√£ s·ª≠a ƒë·ªïi
    end
})

-- H√†m ƒë·ªÉ ƒë√≥ng ho·∫∑c thu nh·ªè c·ª≠a s·ªï (toggle)
local minimized = false
local function toggleMinimize()
    minimized = not minimized
    if minimized then
        Window:SetSize(UDim2.fromOffset(160, 60)) -- Adjust for a smaller minimized size
        Window:SetProperty("Acrylic", false)

        -- ·∫®n t·∫•t c·∫£ c√°c tab
        for _, tab in ipairs(Window:GetTabs()) do
            tab:SetProperty("Visible", false)
        end

        Window.TitleBar:SetProperty("Visible", false)
        Window.SubTitleLabel:SetProperty("Visible", false)

    else
        Window:SetSize(UDim2.fromOffset(580, 460)) -- Restore original size
        Window:SetProperty("Acrylic", true)
        for _, tab in ipairs(Window:GetTabs()) do
            tab:SetProperty("Visible", true)
        end

        Window.TitleBar:SetProperty("Visible", true)
        Window.SubTitleLabel:SetProperty("Visible", true)
    end
end
Window.MinimizeKeybind = toggleMinimize
while true do task.wait(0.00001) 
print("Ey yo Dung Su Chat gpt em oi üò≠")
end